# LocalCloud v0.39.2 — Release Notes & Quickstart

LocalCloud is an **AWS emulator** (single-process, local) with an optional desktop UI (“LocalCloud Manager”), demo projects, and optional EC2 compute emulation via QEMU.

**Evaluation/testing only.** LocalCloud is provided **“AS IS”** with **no warranties, guarantees, or SLAs**. See `EULA.md` in this repository.

This document is a practical, end-to-end guide for:
- Installing LocalCloud components
- Running the emulator
- Using the LocalCloud Manager UI
- Installing EC2 AMI root disks (optional, only if you need EC2 compute)
- Running the included demos

---

## Table of contents

- [Install](#install)
  - [Desktop vs system installs](#desktop-vs-system-installs)
  - [Where files go (paths)](#where-files-go-paths)
- [Run the emulator](#run-the-emulator)
  - [Verify it’s up](#verify-its-up)
  - [AWS CLI / SDK configuration](#aws-cli--sdk-configuration)
  - [Service routing (localhost vs subdomains)](#service-routing-localhost-vs-subdomains)
  - [Run multiple instances](#run-multiple-instances)
- [LocalCloud Manager UI](#localcloud-manager-ui)
  - [Linux UI prerequisites](#linux-ui-prerequisites)
- [EC2 compute (optional)](#ec2-compute-optional)
  - [Enable EC2 infrastructure mode](#enable-ec2-infrastructure-mode)
  - [Install EC2 AMI root disks](#install-ec2-ami-root-disks)
  - [Where LocalCloud looks for root disks](#where-localcloud-looks-for-root-disks)
- [Demos](#demos)
  - [Where demos are installed](#where-demos-are-installed)
  - [Quick start: run one demo](#quick-start-run-one-demo)
  - [Run multiple demos](#run-multiple-demos)
- [Troubleshooting](#troubleshooting)
- [Uninstall / remove](#uninstall--remove)
- [Support](#support)

---

## Install

LocalCloud can be installed in multiple ways depending on your org’s rollout (Homebrew/APT/Winget/installer script). Once `localcloud` is on your PATH, you can install the full product components.

### Install LocalCloud components for v0.39.2

This installs: CLI + emulator entrypoint + (optional) UI + Python + Terraform + demos.

Docker is **recommended** (and required for ECS/Lambda/OpenSearch). If Docker isn’t installed or running, `localcloud install` will continue but those services won’t work until Docker is available.

**Desktop (recommended for laptops):**
```bash
localcloud install --version 0.39.2
```

**System-wide (recommended for shared servers):**
```bash
sudo localcloud install --system --version 0.39.2
```

**Headless servers (skip the UI):**
```bash
sudo localcloud install --system --no-ui --version 0.39.2
```

**Custom install prefix:**
```bash
localcloud install --prefix ~/localcloud --version 0.39.2
```

**Offline / airgapped:**
1. Obtain an offline bundle directory that contains `manifest.json` and the artifacts.
2. Install from that directory:
```bash
localcloud install --offline --offline-dir /path/to/offline-bundle
```

**Release downloads source**

LocalCloud downloads a release manifest from:
- `https://releases.localcloud.dev/stable/manifest.json` (channel)
- `https://releases.localcloud.dev/0.39.2/manifest.json` (pinned release)

You can override the base URL:
```bash
export LOCALCLOUD_RELEASE_URL="https://releases.localcloud.dev"
```

---

## Desktop vs system installs

LocalCloud supports three installation styles:

1) **Desktop install** (default)  
Installs into your home directory (default `~/.localcloud`). Best for evaluation and dev.

2) **System install** (`--system`)  
Installs into system directories (e.g. Linux `/opt/localcloud`, config in `/etc/localcloud`, data in `/var/lib/localcloud`). Best for shared servers.

3) **Custom prefix** (`--prefix` or `LOCALCLOUD_HOME`)  
Installs into a custom directory you control.

Examples:
```bash
export LOCALCLOUD_HOME="$HOME/localcloud"
localcloud install --version 0.39.2
```

---

## Where files go (paths)

### Desktop install (default)
- Install root: `${HOME}/.localcloud`
- Binaries: `${HOME}/.localcloud/bin`
- Config: `${HOME}/.localcloud/config/config.yml`
- Demos: `${HOME}/.localcloud/demos`
- Data: `${HOME}/.localcloud` (subdirectories used by components)

### System install (Linux)
- Install root: `/opt/localcloud`
- Binaries: `/opt/localcloud/bin`
- Config: `/etc/localcloud/config.yml`
- Demos: `/opt/localcloud/demos`
- Data: `/var/lib/localcloud`
- Logs: `/var/log/localcloud`
- Cache: `/var/cache/localcloud`

### Config discovery (when you don’t pass `-c`)

When you start the emulator without `--config`, LocalCloud searches for a config (high-level):
- `--config` flag / `VENUS_CONFIG`
- local dev configs (when running from a repo checkout)
- desktop config under `${LOCALCLOUD_HOME}/config/config.yml`
- system config under `/etc/localcloud/config.yml`
- embedded defaults (always available)

To see a quick config summary:
```bash
localcloud config show
# or:
localcloud config show -c /etc/localcloud/config.yml
```

---

## Run the emulator

Start AWS emulation:
```bash
localcloud --cloud=aws
```

Useful overrides:
```bash
# Explicit region/port (single-region emulator)
localcloud --cloud=aws --region us-east-1 --port 4566

# Limit enabled AWS services (comma-separated)
localcloud --cloud=aws --aws-services iam,sts,s3,dynamodb

# Development-only: accept unsigned AWS requests (NOT recommended outside dev)
localcloud --cloud=aws --aws-no-auth
```

### Verify it’s up

Health endpoint:
```bash
curl -s http://127.0.0.1:4566/health | jq
```

What to look for:
- `ok: true`
- `plugins.<service>.ok: true`
- `capabilities.compute_ready` (if you’re using EC2 compute)
- `disabled_services` and `actions` (things to fix)

Status from CLI:
```bash
localcloud status
localcloud instances list
```

### AWS CLI / SDK configuration

Desktop installs default to LocalStack-style test creds:
- Access key: `test`
- Secret key: `test`
- Region: `us-east-1` (default)

Example:
```bash
export AWS_ACCESS_KEY_ID=test
export AWS_SECRET_ACCESS_KEY=test
export AWS_DEFAULT_REGION=us-east-1

aws --endpoint-url=http://127.0.0.1:4566 sts get-caller-identity
```

Profiles example:
```bash
aws configure --profile localcloud
# set access_key=test, secret_key=test, region=us-east-1

aws --profile localcloud --endpoint-url=http://127.0.0.1:4566 s3 ls
```

### Service routing (localhost vs subdomains)

LocalCloud supports two routing modes:

1) **Localhost routing (LocalStack-style)**  
Use a plain endpoint URL:
```bash
aws --endpoint-url=http://localhost:4566 s3 ls
```
LocalCloud infers the service from request headers/targets/actions.

2) **Host-based routing (recommended for fidelity + edge cases)**  
Use a service subdomain:
```bash
export LOCALCLOUD_HOST="127.0.0.1.nip.io:4566"
aws --endpoint-url="http://s3.us-east-1.aws.${LOCALCLOUD_HOST}" s3 ls
```

### Run multiple instances

Use `--instance` to isolate a second LocalCloud instance (separate ports + storage):
```bash
localcloud --cloud=aws --instance 1
```

---

## LocalCloud Manager UI

The LocalCloud Manager UI is a desktop application that helps you:
- View service status
- Show health/status/logs
- Guide setup and prerequisites
- Discover and run demos (via the emulator demo manifest)

Demo manifest endpoint:
```bash
curl -s http://127.0.0.1:4566/_localcloud/demos | jq
```

### Linux UI prerequisites

Linux builds use WebKitGTK (Wails).

Ubuntu/Debian:
```bash
sudo apt-get update
sudo apt-get install -y pkg-config libwebkit2gtk-4.1-dev
```

(If your distro uses 4.0 instead of 4.1, install `libwebkit2gtk-4.0-dev`.)

---

## EC2 compute (optional)

LocalCloud can emulate EC2 “state APIs” everywhere, and can optionally run high-fidelity EC2 compute using **QEMU**.

### Enable EC2 infrastructure mode

1) Check prerequisites:
```bash
localcloud doctor
```

2) Ensure EC2 infrastructure mode is enabled in config:
```yaml
plugins:
  aws-ec2:
    infrastructure:
      enabled: true
      allow_state_only: false
```

3) Start the emulator and confirm compute capability:
```bash
curl -s http://127.0.0.1:4566/health | jq '.capabilities'
```

### Install EC2 AMI root disks

EC2 compute requires local root disk images (“rootfs”) for the AMIs you want to run.

LocalCloud provides **two related commands**:

#### A) Download published root disks (recommended)

Downloads prebuilt EC2 root disk artifacts from the LocalCloud release bucket (no AWS credentials required).

```bash
# Uses the stable channel manifest by default.
localcloud install ec2 -c ~/.localcloud/config/config.yml

# Or pin a specific release when needed:
localcloud install ec2 -c ~/.localcloud/config/config.yml --release 0.39.2
```

#### B) Bootstrap a single image from AWS (advanced)

Use this only if root disks aren’t published for your release, or if you’re testing a new AMI.

```bash
localcloud install ec2 bootstrap-rootfs \
  -c ~/.localcloud/config/config.yml \
  --image-id ami-0a202301202601204 \
  --source-ssm-parameter /aws/service/ami-amazon-linux-latest/al2023-ami-kernel-6.1-x86_64
```

Or with an explicit AMI ID:
```bash
localcloud install ec2 bootstrap-rootfs \
  -c ~/.localcloud/config/config.yml \
  --image-id ami-1234567890abcdef0 \
  --source-ami-id ami-1234567890abcdef0
```

Notes:
- Bootstrapping uses AWS APIs (SSM/EC2/EBS) and requires AWS credentials on the host.
- Root disk bootstrapping includes patching for LocalCloud’s QEMU environment.
- Bootstrapping coordinates across processes to avoid duplicate concurrent downloads.

### Where LocalCloud looks for root disks

Root disks live under:
```text
<rootfs_dir>/<image_id>/<root_disk_path>
```

When `rootfs_dir: auto`, LocalCloud resolves a stable location in this order:
1) `/data/localcloud/ec2/rootfs` (only if it exists and is writable)
2) a stable temp location like `/tmp/localcloud/ec2/rootfs` (when EC2 base path is under temp)
3) `<ec2.base_path>/rootfs` (when EC2 base path is absolute)
4) `${LOCALCLOUD_HOME}/data/ec2/rootfs` (default desktop: `~/.localcloud/data/ec2/rootfs`)

If you see permissions errors with a shared rootfs path, point rootfs to a user-writable directory:
```bash
localcloud install ec2 -c ~/.localcloud/config/config.yml \
  --rootfs-dir ~/.localcloud/data/ec2/rootfs \
  --image-id ami-0a202301202601204
```

---

## Demos

LocalCloud includes a curated set of demos that exercise AWS emulation with real clients (Terraform, AWS CLI, Python).

### Where demos are installed

- Desktop: `~/.localcloud/demos`
- System (Linux): `/opt/localcloud/demos`

If you installed system-wide, copy demos into a writable directory before running:
```bash
mkdir -p ~/localcloud-demos
cp -a /opt/localcloud/demos/. ~/localcloud-demos/
cd ~/localcloud-demos
```

### Demo prerequisites (common)

- LocalCloud running: `curl http://127.0.0.1:4566/health`
- `curl`, `jq` (recommended)
- Python 3.8+ (LocalCloud installs Python as part of `localcloud install`)
- Terraform (LocalCloud installs Terraform as part of `localcloud install`)
- Docker for container-dependent services (Lambda container backend, OpenSearch, ECS, etc.)
- QEMU for the EC2 compute demo (`ec2-webapp-ssm`)

Many demos accept:
```bash
export LOCALCLOUD_HOST="127.0.0.1.nip.io:4566"
```

### Quick start: run one demo

**Direct API (no Lambda):**
```bash
cd ~/.localcloud/demos/direct-api
./scripts/deploy.sh
./scripts/seed-data.sh
./scripts/test.sh
./scripts/destroy.sh
```

**Serverless Todo (requires Docker, uses Lambda):**
```bash
cd ~/.localcloud/demos/serverless-todo
./scripts/deploy.sh
./scripts/test.sh
./scripts/destroy.sh
```

---

## Troubleshooting

Common checks:
```bash
localcloud doctor
curl -s http://127.0.0.1:4566/health | jq
```

Common issues:
- **Docker not ready**: Install/start Docker; rerun `localcloud doctor`.
- **EC2 compute not ready**: Install QEMU; ensure root disks are installed (`localcloud install ec2 ...`).

---

## Uninstall / remove

Desktop install:
```bash
localcloud uninstall
```

System install:
```bash
sudo localcloud uninstall --system
```

---

## Support

Email: support@eyequs.com
